# Kurly ìŠ¤í‚¨ì¼€ì–´ ì´ˆê¸° ì„ë² ë”© ê°€ì´ë“œ

PostgreSQL â†’ Ollama BGE-M3 â†’ Qdrant ì´ˆê¸° ëŒ€ëŸ‰ ë°ì´í„° ë¡œë”©

---

## ğŸ¯ **ëª©ì **

- **ì´ˆê¸° ëŒ€ëŸ‰ ë°ì´í„° ì„ë² ë”©** (Product 276ê°œ + Review 102,006ê°œ)
- n8n ëŒ€ì‹  Python ìŠ¤í¬ë¦½íŠ¸ ì‚¬ìš© (10ë°° ì´ìƒ ë¹ ë¦„!)
- ì²´í¬í¬ì¸íŠ¸ ê¸°ëŠ¥ (ì¤‘ë‹¨/ì¬ê°œ ê°€ëŠ¥)

---

## ğŸ“‹ **ì‚¬ì „ ì¤€ë¹„**

### 1. Python íŒ¨í‚¤ì§€ ì„¤ì¹˜

```bash
pip install requests tqdm
```

### 2. ì„œë¹„ìŠ¤ ì‹¤í–‰ í™•ì¸

```bash
# Docker ì»¨í…Œì´ë„ˆ í™•ì¸
docker ps | grep -E "postgres|ollama|qdrant"

# Ollama BGE-M3 ëª¨ë¸ í™•ì¸
docker exec ollama ollama list | grep bge-m3

# Qdrant ì»¬ë ‰ì…˜ í™•ì¸
curl http://localhost:6333/collections/kurly_skin
```

### 3. Qdrant ì»¬ë ‰ì…˜ ìƒì„± (ì•„ì§ ì•ˆ í–ˆë‹¤ë©´) ë˜ëŠ” ì´ˆê¸°í™”

```bash
cd /home/julia/workspace/shopping_project
./setup_qdrant_collection.sh
```

---

## ğŸš€ **ì‚¬ìš© ë°©ë²•**

### **ì „ì²´ ì²˜ë¦¬ (Product + Review)**

```bash
python initial_embedding.py --all
```

### **Productë§Œ ì²˜ë¦¬**

```bash
python initial_embedding.py --product
```

### **Reviewë§Œ ì²˜ë¦¬**

```bash
python initial_embedding.py --review
```

---

## â±ï¸ **ì˜ˆìƒ ì†Œìš” ì‹œê°„**

| í•­ëª© | ê°œìˆ˜ | ì˜ˆìƒ ì‹œê°„ |
|------|------|----------|
| Product | 276ê°œ | 5-10ë¶„ |
| Review | 102,006ê°œ | 3-5ì‹œê°„ |
| **ì „ì²´** | **102,282ê°œ** | **3-5ì‹œê°„** |

**ì°¸ê³ :**
- Ollama ì†ë„ì— ë”°ë¼ ë‹¤ë¦„
- ë°°ì¹˜ í¬ê¸°: 50ê°œì”© ì²˜ë¦¬
- ì¬ì‹œë„ ë¡œì§ í¬í•¨

---

## ğŸ“Š **ì‹¤í–‰ í™”ë©´ ì˜ˆì‹œ**

```
======================================================================
   Kurly ìŠ¤í‚¨ì¼€ì–´ ì´ˆê¸° ì„ë² ë”© ìŠ¤í¬ë¦½íŠ¸
======================================================================

â° ì‹œì‘ ì‹œê°„: 2026-02-05 22:30:00

======================================================================
ğŸ“¦ Product ì„ë² ë”© ì‹œì‘
======================================================================
ğŸ“Š PostgreSQLì—ì„œ Product ì¡°íšŒ ì¤‘...
âœ… ì´ 276ê°œ Product ë°œê²¬
Processing Products: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 276/276 [05:23<00:00,  1.17s/item]

======================================================================
ğŸ“¦ Product ì²˜ë¦¬ ì™„ë£Œ!
   âœ… ì„±ê³µ: 276
   â­ï¸  ìŠ¤í‚µ: 0
   âŒ ì‹¤íŒ¨: 0
======================================================================

======================================================================
ğŸ“ Review ì„ë² ë”© ì‹œì‘
======================================================================
ğŸ“Š PostgreSQLì—ì„œ Review ì¡°íšŒ ì¤‘...
âœ… ì´ 102,006ê°œ Review ë°œê²¬
Processing Reviews: 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ      | 45900/102006 [1:53:45<2:20:12,  6.7item/s]
```

---

## âš ï¸ **ì¤‘ë‹¨ ë° ì¬ê°œ**

### **ì¤‘ë‹¨ ë°©ë²•**

```
Ctrl+C
```

ì²´í¬í¬ì¸íŠ¸ê°€ ìë™ìœ¼ë¡œ ì €ì¥ë©ë‹ˆë‹¤!

### **ì¬ê°œ ë°©ë²•**

```bash
# ë™ì¼í•œ ëª…ë ¹ì–´ë¡œ ë‹¤ì‹œ ì‹¤í–‰
python initial_embedding.py --all
```

**ì´ë¯¸ ì²˜ë¦¬ëœ ë°ì´í„°ëŠ” ìë™ìœ¼ë¡œ ìŠ¤í‚µ**ë©ë‹ˆë‹¤! âœ¨

---

## ğŸ“ **ì²´í¬í¬ì¸íŠ¸ íŒŒì¼**

**ìœ„ì¹˜:** `embedding_checkpoint.json`

**ë‚´ìš©:**
```json
{
  "products": [1, 2, 3, ...],  // ì²˜ë¦¬ ì™„ë£Œëœ Product ID
  "reviews": [1, 2, 3, ...]    // ì²˜ë¦¬ ì™„ë£Œëœ Review ID
}
```

**ìˆ˜ë™ ì´ˆê¸°í™”:**
```bash
rm embedding_checkpoint.json
```

---

## ğŸ” **ì§„í–‰ìƒí™© í™•ì¸**

### **Qdrant ë°ì´í„° í™•ì¸**

```bash
# ì „ì²´ ë²¡í„° ê°œìˆ˜
curl http://localhost:6333/collections/kurly_skin | jq '.result.points_count'

# ìƒì„¸ ì •ë³´
curl http://localhost:6333/collections/kurly_skin | jq
```

### **ì‹¤ì‹œê°„ ëª¨ë‹ˆí„°ë§**

```bash
# ë‹¤ë¥¸ í„°ë¯¸ë„ì—ì„œ
watch -n 5 'curl -s http://localhost:6333/collections/kurly_skin | jq ".result.points_count"'
```

---

## ğŸ› **ë¬¸ì œ í•´ê²°**

### **1. "docker: command not found"**

```bash
# Docker ì„¤ì¹˜ í™•ì¸
docker --version

# Docker ì„œë¹„ìŠ¤ ì‹œì‘
sudo systemctl start docker
```

### **2. "Connection refused" (Ollama)**

```bash
# Ollama ì»¨í…Œì´ë„ˆ ì¬ì‹œì‘
docker restart ollama

# ë¡œê·¸ í™•ì¸
docker logs ollama
```

### **3. "Connection refused" (Qdrant)**

```bash
# Qdrant ì»¨í…Œì´ë„ˆ ì¬ì‹œì‘
docker restart qdrant

# ë¡œê·¸ í™•ì¸
docker logs qdrant
```

### **4. "Maximum call stack size exceeded"**

â†’ ì´ ë¬¸ì œëŠ” n8nì—ì„œë§Œ ë°œìƒ! Python ìŠ¤í¬ë¦½íŠ¸ëŠ” ë¬¸ì œì—†ìŒ âœ…

### **5. ë„ˆë¬´ ëŠë¦¼**

**BATCH_SIZE ì¡°ì •:**

`initial_embedding.py` íŒŒì¼ ìˆ˜ì •:

```python
BATCH_SIZE = 100  # ê¸°ë³¸ê°’: 50
```

---

## ğŸ“ˆ **ì„±ëŠ¥ ë¹„êµ**

| ë°©ë²• | ì†ë„ | ì•ˆì •ì„± | ì¬ê°œ | ëª¨ë‹ˆí„°ë§ |
|------|------|--------|------|----------|
| **Python ìŠ¤í¬ë¦½íŠ¸** | âš¡âš¡âš¡ | âœ… | âœ… | âœ… |
| n8n | ğŸŒ | âŒ | âŒ | âœ… |

**Python ìŠ¤í¬ë¦½íŠ¸ê°€ 10ë°° ì´ìƒ ë¹ ë¦…ë‹ˆë‹¤!**

---

## ğŸ”„ **ë‹¤ìŒ ë‹¨ê³„: ì¦ë¶„ ì—…ë°ì´íŠ¸ (n8n)**

ì´ˆê¸° ë¡œë”© ì™„ë£Œ í›„:

1. **n8n ì›Œí¬í”Œë¡œìš°** ì‚¬ìš©
2. **Schedule Trigger** (ë§¤ì¼ ìƒˆë²½ 3ì‹œ)
3. **ìƒˆë¡œìš´ ë°ì´í„°ë§Œ** ì²˜ë¦¬
4. **Slack ì•Œë¦¼** ìë™í™”

```
ë§¤ì¼ ìë™ ì‹¤í–‰:
- ìƒˆ Product: 0-10ê°œ
- ìƒˆ Review: 100-500ê°œ
- 5-10ë¶„ ì†Œìš”
```

---

## âœ… **ì™„ë£Œ í™•ì¸**

```bash
# Qdrant ë°ì´í„° í™•ì¸
curl http://localhost:6333/collections/kurly_skin | jq '.result.points_count'

# ì˜ˆìƒ ê²°ê³¼: 102,282 (276 + 102,006)
```

---

## ğŸ¯ **ìš”ì•½**

1. âœ… **ì‚¬ì „ ì¤€ë¹„** (íŒ¨í‚¤ì§€, ì„œë¹„ìŠ¤ í™•ì¸)
2. âœ… **ì‹¤í–‰**: `python initial_embedding.py --all`
3. âœ… **3-5ì‹œê°„ ëŒ€ê¸°** (ë˜ëŠ” ì¤‘ë‹¨ í›„ ì¬ê°œ)
4. âœ… **í™•ì¸**: Qdrant points_count
5. âœ… **ë‹¤ìŒ ë‹¨ê³„**: n8n ì¦ë¶„ ì—…ë°ì´íŠ¸

---

## ğŸ’¡ **íŒ**

- â˜• **ì»¤í”¼ í•œ ì”** í•˜ê³  ì˜¤ì„¸ìš” (3-5ì‹œê°„ ì†Œìš”)
- ğŸ”‹ **ì „ì› ì—°ê²°** í•„ìˆ˜!
- ğŸŒ™ **ë°¤ì— ì‹¤í–‰** ì¶”ì²œ (ë¦¬ì†ŒìŠ¤ ì¶©ë¶„)
- ğŸ’¾ **ì²´í¬í¬ì¸íŠ¸** í™œìš© (ì–¸ì œë“  ì¤‘ë‹¨/ì¬ê°œ)

---

**Happy Embedding!** ğŸš€âœ¨
